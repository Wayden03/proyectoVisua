---
title: "Accidentes de tránsito en Costa Rica"
output: html_document
---

Isaac Cordero Tapia - c2022193583 || Santiago Moreno Granados - c2022040858

```{r, echo=FALSE}
source('setup.r') #para agarrar las librerias
data <- read.csv("accidentes.csv", header=TRUE, sep=";")
```

Gráficas Unidimensionales:

```{r, echo=FALSE}

plot1 <- ggplot(data, aes(Clase.de.accidente, fill=Clase.de.accidente)) +
  geom_bar() +
  labs(title = "Clase de Accidente", x = "Clase de Accidente", y = "Cantidad")

plot2 <- ggplot(data, aes(x="", y="Tipo de accidente", fill=Tipo.de.accidente)) +
  geom_bar(stat="identity", width=1) +
  coord_polar("y", start=0) +
  labs(title = "Tipo de Accidente", x = "Tipo de Accidente", fill = "Tipo de accidente")


plot3 <- ggplot(data, aes(Provincia, fill=Provincia)) +
  geom_bar() +
  labs(title = "Accidentes por Provincia", x = "Provincia", y = "Cantidad", fill = "Tipo de accidente")

plot1
plot2
plot3
```

Gráfica Bidimensional

```{r, echo = FALSE}
plot4 <- ggplot(data, aes(x = Provincia, fill = Tipo.de.accidente)) +
  geom_bar(position = "identity")  +
  ggtitle("Tipos de accidente por provincia") +
  labs(x = "Provincia", y = "Cantidad", fill = "Tipo de accidente") 
plot4
```

Gráfica de Facetas

```{r, echo = FALSE}
plot6 <- ggplot(data, aes(x = Clase.de.accidente, fill = Estado.de.la.calzada)) +
geom_bar() + facet_grid(. ~ Estado.del.tiempo) +
labs(title = "Accidentes según estado del tiempo, de la calzada y su gravedad", x = "Tipo de accidente", y = "Cantidad", fill = "Estado de la calzada") + theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))
plot6
```

